"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[363],{6443:function(e,t,i){i.d(t,{qQ:function(){return C}});let r="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",s={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},o={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},n={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},a={b:[16,32,17,15],w:[-16,-32,-17,-15]},l={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},h=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],u=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],_={p:1,n:2,b:4,r:8,q:16,k:32},f=["n","b","r","q"],d={k:o.KSIDE_CASTLE,q:o.QSIDE_CASTLE},p={w:[{square:n.a1,flag:o.QSIDE_CASTLE},{square:n.h1,flag:o.KSIDE_CASTLE}],b:[{square:n.a8,flag:o.QSIDE_CASTLE},{square:n.h8,flag:o.KSIDE_CASTLE}]},c={b:1,w:6},g=["1-0","0-1","1/2-1/2","*"];function m(e){return -1!=="0123456789".indexOf(e)}function b(e){let t=15&e,i=e>>4;return"abcdefgh".substring(t,t+1)+"87654321".substring(i,i+1)}function k(e){return"w"===e?"b":"w"}function v(e,t,i,r,s,n,a=o.NORMAL){let l=r>>4;if("p"===s&&(7===l||0===l))for(let l=0;l<f.length;l++){let h=f[l];e.push({color:t,from:i,to:r,piece:s,captured:n,promotion:h,flags:a|o.PROMOTION})}else e.push({color:t,from:i,to:r,piece:s,captured:n,flags:a})}function E(e){let t=e.charAt(0);if(t>="a"&&t<="h"){if(e.match(/[a-h]\d.*[a-h]\d/))return;return"p"}return"o"===(t=t.toLowerCase())?"k":t}function S(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class C{_board=Array(128);_turn="w";_header={};_kings={w:-1,b:-1};_epSquare=-1;_halfMoves=0;_moveNumber=0;_history=[];_comments={};_castling={w:0,b:0};constructor(e=r){this.load(e)}clear(e=!1){this._board=Array(128),this._kings={w:-1,b:-1},this._turn="w",this._castling={w:0,b:0},this._epSquare=-1,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=e?this._header:{},this._updateSetup(this.fen())}removeHeader(e){e in this._header&&delete this._header[e]}load(e,t=!1){let i=e.split(/\s+/);i.length>=2&&i.length<6&&(e=i.concat(["-","-","0","1"].slice(-(6-i.length))).join(" ")),i=e.split(/\s+/);let{ok:r,error:s}=function(e){let t=e.split(/\s+/);if(6!==t.length)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};let i=parseInt(t[5],10);if(isNaN(i)||i<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};let r=parseInt(t[4],10);if(isNaN(r)||r<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(t[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(t[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(t[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};let s=t[0].split("/");if(8!==s.length)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let e=0;e<s.length;e++){let t=0,i=!1;for(let r=0;r<s[e].length;r++)if(m(s[e][r])){if(i)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};t+=parseInt(s[e][r],10),i=!0}else{if(!/^[prnbqkPRNBQK]$/.test(s[e][r]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};t+=1,i=!1}if(8!==t)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if("3"==t[3][1]&&"w"==t[1]||"6"==t[3][1]&&"b"==t[1])return{ok:!1,error:"Invalid FEN: illegal en-passant square"};for(let{color:e,regex:i}of[{color:"white",regex:/K/g},{color:"black",regex:/k/g}]){if(!i.test(t[0]))return{ok:!1,error:`Invalid FEN: missing ${e} king`};if((t[0].match(i)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${e} kings`}}return{ok:!0}}(e);if(!r)throw Error(s);let a=i[0],l=0;this.clear(t);for(let e=0;e<a.length;e++){let t=a.charAt(e);if("/"===t)l+=8;else if(m(t))l+=parseInt(t,10);else{let e=t<"a"?"w":"b";this.put({type:t.toLowerCase(),color:e},b(l)),l++}}this._turn=i[1],i[2].indexOf("K")>-1&&(this._castling.w|=o.KSIDE_CASTLE),i[2].indexOf("Q")>-1&&(this._castling.w|=o.QSIDE_CASTLE),i[2].indexOf("k")>-1&&(this._castling.b|=o.KSIDE_CASTLE),i[2].indexOf("q")>-1&&(this._castling.b|=o.QSIDE_CASTLE),this._epSquare="-"===i[3]?-1:n[i[3]],this._halfMoves=parseInt(i[4],10),this._moveNumber=parseInt(i[5],10),this._updateSetup(this.fen())}fen(){let e=0,t="";for(let i=n.a8;i<=n.h1;i++){if(this._board[i]){e>0&&(t+=e,e=0);let{color:r,type:s}=this._board[i];t+="w"===r?s.toUpperCase():s.toLowerCase()}else e++;i+1&136&&(e>0&&(t+=e),i!==n.h1&&(t+="/"),e=0,i+=8)}let i="";this._castling.w&o.KSIDE_CASTLE&&(i+="K"),this._castling.w&o.QSIDE_CASTLE&&(i+="Q"),this._castling.b&o.KSIDE_CASTLE&&(i+="k"),this._castling.b&o.QSIDE_CASTLE&&(i+="q"),i=i||"-";let r="-";if(-1!==this._epSquare){let e=this._epSquare+("w"===this._turn?16:-16);for(let t of[e+1,e-1]){if(136&t)continue;let e=this._turn;if(this._board[t]?.color===e&&this._board[t]?.type==="p"){this._makeMove({color:e,from:t,to:this._epSquare,piece:"p",captured:"p",flags:o.EP_CAPTURE});let i=!this._isKingAttacked(e);if(this._undoMove(),i){r=b(this._epSquare);break}}}}return[t,this._turn,i,r,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(e){this._history.length>0||(e!==r?(this._header.SetUp="1",this._header.FEN=e):(delete this._header.SetUp,delete this._header.FEN))}reset(){this.load(r)}get(e){return this._board[n[e]]||!1}put({type:e,color:t},i){if(-1==="pnbrqkPNBRQK".indexOf(e.toLowerCase())||!(i in n))return!1;let r=n[i];return("k"!=e||-1==this._kings[t]||this._kings[t]==r)&&(this._board[r]={type:e,color:t},"k"===e&&(this._kings[t]=r),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0)}remove(e){let t=this.get(e);return delete this._board[n[e]],t&&"k"===t.type&&(this._kings[t.color]=-1),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),t}_updateCastlingRights(){let e=this._board[n.e1]?.type==="k"&&this._board[n.e1]?.color==="w",t=this._board[n.e8]?.type==="k"&&this._board[n.e8]?.color==="b";e&&this._board[n.a1]?.type==="r"&&this._board[n.a1]?.color==="w"||(this._castling.w&=~o.QSIDE_CASTLE),e&&this._board[n.h1]?.type==="r"&&this._board[n.h1]?.color==="w"||(this._castling.w&=~o.KSIDE_CASTLE),t&&this._board[n.a8]?.type==="r"&&this._board[n.a8]?.color==="b"||(this._castling.b&=~o.QSIDE_CASTLE),t&&this._board[n.h8]?.type==="r"&&this._board[n.h8]?.color==="b"||(this._castling.b&=~o.KSIDE_CASTLE)}_updateEnPassantSquare(){if(-1===this._epSquare)return;let e=this._epSquare+("w"===this._turn?-16:16),t=this._epSquare+("w"===this._turn?16:-16);if(null!==this._board[e]||null!==this._board[this._epSquare]||this._board[t]?.color!==k(this._turn)||this._board[t]?.type!=="p"){this._epSquare=-1;return}[t+1,t-1].some(e=>!(136&e)&&this._board[e]?.color===this._turn&&this._board[e]?.type==="p")||(this._epSquare=-1)}_attacked(e,t){for(let i=n.a8;i<=n.h1;i++){if(136&i){i+=7;continue}if(void 0===this._board[i]||this._board[i].color!==e)continue;let r=this._board[i],s=i-t;if(0===s)continue;let o=s+119;if(h[o]&_[r.type]){if("p"===r.type){if(s>0){if("w"===r.color)return!0}else if("b"===r.color)return!0;continue}if("n"===r.type||"k"===r.type)return!0;let e=u[o],n=i+e,a=!1;for(;n!==t;){if(null!=this._board[n]){a=!0;break}n+=e}if(!a)return!0}}return!1}_isKingAttacked(e){let t=this._kings[e];return -1!==t&&this._attacked(k(e),t)}isAttacked(e,t){return this._attacked(t,n[e])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&0===this._moves().length}isStalemate(){return!this.isCheck()&&0===this._moves().length}isInsufficientMaterial(){let e={b:0,n:0,r:0,q:0,k:0,p:0},t=[],i=0,r=0;for(let s=n.a8;s<=n.h1;s++){if(r=(r+1)%2,136&s){s+=7;continue}let o=this._board[s];o&&(e[o.type]=o.type in e?e[o.type]+1:1,"b"===o.type&&t.push(r),i++)}if(2===i||3===i&&(1===e.b||1===e.n))return!0;if(i===e.b+2){let e=0,i=t.length;for(let r=0;r<i;r++)e+=t[r];if(0===e||e===i)return!0}return!1}isThreefoldRepetition(){let e=[],t={},i=!1;for(;;){let t=this._undoMove();if(!t)break;e.push(t)}for(;;){let r=this.fen().split(" ").slice(0,4).join(" ");t[r]=r in t?t[r]+1:1,t[r]>=3&&(i=!0);let s=e.pop();if(s)this._makeMove(s);else break}return i}isDraw(){return this._halfMoves>=100||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:e=!1,square:t,piece:i}={}){let r=this._moves({square:t,piece:i});return e?r.map(e=>this._makePretty(e)):r.map(e=>this._moveToSan(e,r))}_moves({legal:e=!0,piece:t,square:i}={}){let r=i?i.toLowerCase():void 0,s=t?.toLowerCase(),h=[],u=this._turn,_=k(u),f=n.a8,d=n.h1,p=!1;if(r){if(!(r in n))return[];f=d=n[r],p=!0}for(let e=f;e<=d;e++){let t;if(136&e){e+=7;continue}if(!this._board[e]||this._board[e].color===_)continue;let{type:i}=this._board[e];if("p"===i){if(s&&s!==i)continue;t=e+a[u][0],this._board[t]||(v(h,u,e,t,"p"),t=e+a[u][1],c[u]!==e>>4||this._board[t]||v(h,u,e,t,"p",void 0,o.BIG_PAWN));for(let i=2;i<4;i++)136&(t=e+a[u][i])||(this._board[t]?.color===_?v(h,u,e,t,"p",this._board[t].type,o.CAPTURE):t===this._epSquare&&v(h,u,e,t,"p","p",o.EP_CAPTURE))}else{if(s&&s!==i)continue;for(let r=0,s=l[i].length;r<s;r++){let s=l[i][r];for(t=e;!(136&(t+=s));){if(this._board[t]){if(this._board[t].color===u)break;v(h,u,e,t,i,this._board[t].type,o.CAPTURE);break}if(v(h,u,e,t,i),"n"===i||"k"===i)break}}}}if((void 0===s||"k"===s)&&(!p||d===this._kings[u])){if(this._castling[u]&o.KSIDE_CASTLE){let e=this._kings[u],t=e+2;this._board[e+1]||this._board[t]||this._attacked(_,this._kings[u])||this._attacked(_,e+1)||this._attacked(_,t)||v(h,u,this._kings[u],t,"k",void 0,o.KSIDE_CASTLE)}if(this._castling[u]&o.QSIDE_CASTLE){let e=this._kings[u],t=e-2;this._board[e-1]||this._board[e-2]||this._board[e-3]||this._attacked(_,this._kings[u])||this._attacked(_,e-1)||this._attacked(_,t)||v(h,u,this._kings[u],t,"k",void 0,o.QSIDE_CASTLE)}}if(!e||-1===this._kings[u])return h;let g=[];for(let e=0,t=h.length;e<t;e++)this._makeMove(h[e]),this._isKingAttacked(u)||g.push(h[e]),this._undoMove();return g}move(e,{strict:t=!1}={}){let i=null;if("string"==typeof e)i=this._moveFromSan(e,t);else if("object"==typeof e){let t=this._moves();for(let r=0,s=t.length;r<s;r++)if(e.from===b(t[r].from)&&e.to===b(t[r].to)&&(!("promotion"in t[r])||e.promotion===t[r].promotion)){i=t[r];break}}if(!i){if("string"==typeof e)throw Error(`Invalid move: ${e}`);throw Error(`Invalid move: ${JSON.stringify(e)}`)}let r=this._makePretty(i);return this._makeMove(i),r}_push(e){this._history.push({move:e,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(e){let t=this._turn,i=k(t);if(this._push(e),this._board[e.to]=this._board[e.from],delete this._board[e.from],e.flags&o.EP_CAPTURE&&("b"===this._turn?delete this._board[e.to-16]:delete this._board[e.to+16]),e.promotion&&(this._board[e.to]={type:e.promotion,color:t}),"k"===this._board[e.to].type){if(this._kings[t]=e.to,e.flags&o.KSIDE_CASTLE){let t=e.to-1,i=e.to+1;this._board[t]=this._board[i],delete this._board[i]}else if(e.flags&o.QSIDE_CASTLE){let t=e.to+1,i=e.to-2;this._board[t]=this._board[i],delete this._board[i]}this._castling[t]=0}if(this._castling[t]){for(let i=0,r=p[t].length;i<r;i++)if(e.from===p[t][i].square&&this._castling[t]&p[t][i].flag){this._castling[t]^=p[t][i].flag;break}}if(this._castling[i]){for(let t=0,r=p[i].length;t<r;t++)if(e.to===p[i][t].square&&this._castling[i]&p[i][t].flag){this._castling[i]^=p[i][t].flag;break}}e.flags&o.BIG_PAWN?"b"===t?this._epSquare=e.to-16:this._epSquare=e.to+16:this._epSquare=-1,"p"===e.piece?this._halfMoves=0:e.flags&(o.CAPTURE|o.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,"b"===t&&this._moveNumber++,this._turn=i}undo(){let e=this._undoMove();return e?this._makePretty(e):null}_undoMove(){let e=this._history.pop();if(void 0===e)return null;let t=e.move;this._kings=e.kings,this._turn=e.turn,this._castling=e.castling,this._epSquare=e.epSquare,this._halfMoves=e.halfMoves,this._moveNumber=e.moveNumber;let i=this._turn,r=k(i);if(this._board[t.from]=this._board[t.to],this._board[t.from].type=t.piece,delete this._board[t.to],t.captured){if(t.flags&o.EP_CAPTURE){let e;e="b"===i?t.to-16:t.to+16,this._board[e]={type:"p",color:r}}else this._board[t.to]={type:t.captured,color:r}}if(t.flags&(o.KSIDE_CASTLE|o.QSIDE_CASTLE)){let e,i;t.flags&o.KSIDE_CASTLE?(e=t.to+1,i=t.to-1):(e=t.to-2,i=t.to+1),this._board[e]=this._board[i],delete this._board[i]}return t}pgn({newline:e="\n",maxWidth:t=0}={}){let i=[],r=!1;for(let t in this._header)i.push("["+t+' "'+this._header[t]+'"]'+e),r=!0;r&&this._history.length&&i.push(e);let s=e=>{let t=this._comments[this.fen()];if(void 0!==t){let i=e.length>0?" ":"";e=`${e}${i}{${t}}`}return e},o=[];for(;this._history.length>0;)o.push(this._undoMove());let n=[],a="";for(0===o.length&&n.push(s(""));o.length>0;){a=s(a);let e=o.pop();if(!e)break;if(this._history.length||"b"!==e.color)"w"===e.color&&(a.length&&n.push(a),a=this._moveNumber+".");else{let e=`${this._moveNumber}. ...`;a=a?`${a} ${e}`:e}a=a+" "+this._moveToSan(e,this._moves({legal:!0})),this._makeMove(e)}if(a.length&&n.push(s(a)),void 0!==this._header.Result&&n.push(this._header.Result),0===t)return i.join("")+n.join(" ");let l=function(){return i.length>0&&" "===i[i.length-1]&&(i.pop(),!0)},h=0;for(let r=0;r<n.length;r++){if(h+n[r].length>t&&n[r].includes("{")){h=function(r,s){for(let o of s.split(" "))if(o){if(r+o.length>t){for(;l();)r--;i.push(e),r=0}i.push(o),r+=o.length,i.push(" "),r++}return l()&&r--,r}(h,n[r]);continue}h+n[r].length>t&&0!==r?(" "===i[i.length-1]&&i.pop(),i.push(e),h=0):0!==r&&(i.push(" "),h++),i.push(n[r]),h+=n[r].length}return i.join("")}header(...e){for(let t=0;t<e.length;t+=2)"string"==typeof e[t]&&"string"==typeof e[t+1]&&(this._header[e[t]]=e[t+1]);return this._header}loadPgn(e,{strict:t=!1,newlineChar:i="\r?\n"}={}){function r(e){return e.replace(/\\/g,"\\")}e=e.trim();let s=RegExp("^(\\[((?:"+r(i)+")|.)*\\])((?:\\s*"+r(i)+"){2}|(?:\\s*"+r(i)+")*$)").exec(e),o=s&&s.length>=2?s[1]:"";this.reset();let n=function(e){let t={},s=e.split(new RegExp(r(i))),o="",n="";for(let e=0;e<s.length;e++){let i=/^\s*\[\s*([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;o=s[e].replace(i,"$1"),n=s[e].replace(i,"$2"),o.trim().length>0&&(t[o]=n)}return t}(o),a="";for(let e in n)"fen"===e.toLowerCase()&&(a=n[e]),this.header(e,n[e]);if(t){if("1"===n.SetUp){if(!("FEN"in n))throw Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(n.FEN,!0)}}else a&&this.load(a,!0);let l=function(e){return e=e.replace(RegExp(r(i),"g")," "),`{${Array.from(e.slice(1,e.length-1)).map(function(e){return 128>e.charCodeAt(0)?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/%/g,"").toLowerCase()}).join("")}}`},h=e.replace(o,"").replace(RegExp(`({[^}]*})+?|;([^${r(i)}]*)`,"g"),function(e,t,i){return void 0!==t?l(t):" "+l(`{${i.slice(1)}}`)}).replace(RegExp(r(i),"g")," "),u=/(\([^()]+\))+?/g;for(;u.test(h);)h=h.replace(u,"");let _=(h=(h=(h=h.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).trim().split(new RegExp(/\s+/));_=_.filter(e=>""!==e);let f="";for(let e=0;e<_.length;e++){let i=function(e){if(e.startsWith("{")&&e.endsWith("}")){var t;return 0==(t=e.slice(1,e.length-1)).length?"":decodeURIComponent("%"+(t.match(/.{1,2}/g)||[]).join("%"))}}(_[e]);if(void 0!==i){this._comments[this.fen()]=i;continue}let r=this._moveFromSan(_[e],t);if(null==r){if(g.indexOf(_[e])>-1)f=_[e];else throw Error(`Invalid move in PGN: ${_[e]}`)}else f="",this._makeMove(r)}f&&Object.keys(this._header).length&&!this._header.Result&&this.header("Result",f)}_moveToSan(e,t){let i="";if(e.flags&o.KSIDE_CASTLE)i="O-O";else if(e.flags&o.QSIDE_CASTLE)i="O-O-O";else{if("p"!==e.piece){let r=function(e,t){let i=e.from,r=e.to,s=e.piece,o=0,n=0,a=0;for(let e=0,l=t.length;e<l;e++){let l=t[e].from,h=t[e].to;s===t[e].piece&&i!==l&&r===h&&(o++,i>>4==l>>4&&n++,(15&i)==(15&l)&&a++)}return o>0?n>0&&a>0?b(i):a>0?b(i).charAt(1):b(i).charAt(0):""}(e,t);i+=e.piece.toUpperCase()+r}e.flags&(o.CAPTURE|o.EP_CAPTURE)&&("p"===e.piece&&(i+=b(e.from)[0]),i+="x"),i+=b(e.to),e.promotion&&(i+="="+e.promotion.toUpperCase())}return this._makeMove(e),this.isCheck()&&(this.isCheckmate()?i+="#":i+="+"),this._undoMove(),i}_moveFromSan(e,t=!1){let i,r,s,o,a;let l=S(e),h=E(l),u=this._moves({legal:!0,piece:h});for(let e=0,t=u.length;e<t;e++)if(l===S(this._moveToSan(u[e],u)))return u[e];if(t)return null;let _=!1;if((r=l.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/))?(i=r[1],s=r[2],o=r[3],a=r[4],1==s.length&&(_=!0)):(r=l.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/))&&(i=r[1],s=r[2],o=r[3],a=r[4],1==s.length&&(_=!0)),h=E(l),u=this._moves({legal:!0,piece:i||h}),!o)return null;for(let e=0,t=u.length;e<t;e++)if(s){if((!i||i.toLowerCase()==u[e].piece)&&n[s]==u[e].from&&n[o]==u[e].to&&(!a||a.toLowerCase()==u[e].promotion))return u[e];if(_){let t=b(u[e].from);if((!i||i.toLowerCase()==u[e].piece)&&n[o]==u[e].to&&(s==t[0]||s==t[1])&&(!a||a.toLowerCase()==u[e].promotion))return u[e]}}else if(l===S(this._moveToSan(u[e],u)).replace("x",""))return u[e];return null}ascii(){let e="   +------------------------+\n";for(let t=n.a8;t<=n.h1;t++){if(0==(15&t)&&(e+=" "+"87654321"[t>>4]+" |"),this._board[t]){let i=this._board[t].type;e+=" "+("w"===this._board[t].color?i.toUpperCase():i.toLowerCase())+" "}else e+=" . ";t+1&136&&(e+="|\n",t+=8)}return e+"   +------------------------+\n     a  b  c  d  e  f  g  h"}perft(e){let t=this._moves({legal:!1}),i=0,r=this._turn;for(let s=0,o=t.length;s<o;s++)this._makeMove(t[s]),!this._isKingAttacked(r)&&(e-1>0?i+=this.perft(e-1):i++),this._undoMove();return i}_makePretty(e){let{color:t,piece:i,from:r,to:n,flags:a,captured:l,promotion:h}=e,u="";for(let e in o)o[e]&a&&(u+=s[e]);let _=b(r),f=b(n),d={color:t,piece:i,from:_,to:f,san:this._moveToSan(e,this._moves({legal:!0})),flags:u,lan:_+f,before:this.fen(),after:""};return this._makeMove(e),d.after=this.fen(),this._undoMove(),l&&(d.captured=l),h&&(d.promotion=h,d.lan+=h),d}turn(){return this._turn}board(){let e=[],t=[];for(let i=n.a8;i<=n.h1;i++)null==this._board[i]?t.push(null):t.push({square:b(i),type:this._board[i].type,color:this._board[i].color}),i+1&136&&(e.push(t),t=[],i+=8);return e}squareColor(e){if(e in n){let t=n[e];return((t>>4)+(15&t))%2==0?"light":"dark"}return null}history({verbose:e=!1}={}){let t=[],i=[];for(;this._history.length>0;)t.push(this._undoMove());for(;;){let r=t.pop();if(!r)break;e?i.push(this._makePretty(r)):i.push(this._moveToSan(r,this._moves())),this._makeMove(r)}return i}_pruneComments(){let e=[],t={},i=e=>{e in this._comments&&(t[e]=this._comments[e])};for(;this._history.length>0;)e.push(this._undoMove());for(i(this.fen());;){let t=e.pop();if(!t)break;this._makeMove(t),i(this.fen())}this._comments=t}getComment(){return this._comments[this.fen()]}setComment(e){this._comments[this.fen()]=e.replace("{","[").replace("}","]")}deleteComment(){let e=this._comments[this.fen()];return delete this._comments[this.fen()],e}getComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>({fen:e,comment:this._comments[e]}))}deleteComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>{let t=this._comments[e];return delete this._comments[e],{fen:e,comment:t}})}setCastlingRights(e,t){for(let i of["k","q"])void 0!==t[i]&&(t[i]?this._castling[e]|=d[i]:this._castling[e]&=~d[i]);this._updateCastlingRights();let i=this.getCastlingRights(e);return(void 0===t.k||t.k===i.k)&&(void 0===t.q||t.q===i.q)}getCastlingRights(e){return{k:(this._castling[e]&d.k)!=0,q:(this._castling[e]&d.q)!=0}}moveNumber(){return this._moveNumber}}},166:function(e,t,i){i.d(t,{default:function(){return s.a}});var r=i(5775),s=i.n(r)},5775:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let r=i(7043);i(7437),i(2265);let s=r._(i(2760));function o(e,t){var i;let r={loading:e=>{let{error:t,isLoading:i,pastDelay:r}=e;return null}};"function"==typeof e&&(r.loader=e);let o={...r,...t};return(0,s.default)({...o,modules:null==(i=o.loadableGenerated)?void 0:i.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},1523:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return s}});let r=i(8993);function s(e){let{reason:t,children:i}=e;if("undefined"==typeof window)throw new r.BailoutToCSRError(t);return i}},2760:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return h}});let r=i(7437),s=i(2265),o=i(1523),n=i(49);function a(e){return{default:e&&"default"in e?e.default:e}}let l={loader:()=>Promise.resolve(a(()=>null)),loading:null,ssr:!0},h=function(e){let t={...l,...e},i=(0,s.lazy)(()=>t.loader().then(a)),h=t.loading;function u(e){let a=h?(0,r.jsx)(h,{isLoading:!0,pastDelay:!0,error:null}):null,l=t.ssr?(0,r.jsxs)(r.Fragment,{children:["undefined"==typeof window?(0,r.jsx)(n.PreloadCss,{moduleIds:t.modules}):null,(0,r.jsx)(i,{...e})]}):(0,r.jsx)(o.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(i,{...e})});return(0,r.jsx)(s.Suspense,{fallback:a,children:l})}return u.displayName="LoadableComponent",u}},49:function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return o}});let r=i(7437),s=i(544);function o(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let i=(0,s.getExpectedRequestStore)("next/dynamic css"),o=[];if(i.reactLoadableManifest&&t){let e=i.reactLoadableManifest;for(let i of t){if(!e[i])continue;let t=e[i].files.filter(e=>e.endsWith(".css"));o.push(...t)}}return 0===o.length?null:(0,r.jsx)(r.Fragment,{children:o.map(e=>(0,r.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:i.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}}}]);