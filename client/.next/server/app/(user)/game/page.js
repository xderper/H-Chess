(()=>{var e={};e.id=222,e.ids=[222],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8893:e=>{"use strict";e.exports=require("buffer")},1282:e=>{"use strict";e.exports=require("child_process")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},8791:e=>{"use strict";e.exports=require("https")},8216:e=>{"use strict";e.exports=require("net")},9801:e=>{"use strict";e.exports=require("os")},6162:e=>{"use strict";e.exports=require("stream")},2452:e=>{"use strict";e.exports=require("tls")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},8359:()=>{},3739:()=>{},1092:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>c,originalPathname:()=>d,pages:()=>u,routeModule:()=>_,tree:()=>h}),r(1814),r(1557),r(5866);var i=r(3191),s=r(8716),o=r(7922),n=r.n(o),a=r(5231),l={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);r.d(t,l);let h=["",{children:["(user)",{children:["game",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,1814)),"C:\\Users\\artem\\YandexDisk\\IT\\dev\\client\\src\\app\\(user)\\game\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,1557)),"C:\\Users\\artem\\YandexDisk\\IT\\dev\\client\\src\\app\\(user)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],u=["C:\\Users\\artem\\YandexDisk\\IT\\dev\\client\\src\\app\\(user)\\game\\page.tsx"],d="/(user)/game/page",c={require:r,loadChunk:()=>Promise.resolve()},_=new i.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/(user)/game/page",pathname:"/game",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:h}})},6377:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},5951:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,9404,23))},9868:(e,t,r)=>{Promise.resolve().then(r.bind(r,3039))},3353:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let i=r(1174);r(326),r(7577);let s=i._(r(7028));function o(e,t){var r;let i={loading:e=>{let{error:t,isLoading:r,pastDelay:i}=e;return null}};"function"==typeof e&&(i.loader=e);let o={...i,...t};return(0,s.default)({...o,modules:null==(r=o.loadableGenerated)?void 0:r.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},933:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return s}});let i=r(4129);function s(e){let{reason:t,children:r}=e;throw new i.BailoutToCSRError(t)}},7028:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return h}});let i=r(326),s=r(7577),o=r(933),n=r(6618);function a(e){return{default:e&&"default"in e?e.default:e}}let l={loader:()=>Promise.resolve(a(()=>null)),loading:null,ssr:!0},h=function(e){let t={...l,...e},r=(0,s.lazy)(()=>t.loader().then(a)),h=t.loading;function u(e){let a=h?(0,i.jsx)(h,{isLoading:!0,pastDelay:!0,error:null}):null,l=t.ssr?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.PreloadCss,{moduleIds:t.modules}),(0,i.jsx)(r,{...e})]}):(0,i.jsx)(o.BailoutToCSR,{reason:"next/dynamic",children:(0,i.jsx)(r,{...e})});return(0,i.jsx)(s.Suspense,{fallback:a,children:l})}return u.displayName="LoadableComponent",u}},6618:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return o}});let i=r(326),s=r(4580);function o(e){let{moduleIds:t}=e,r=(0,s.getExpectedRequestStore)("next/dynamic css"),o=[];if(r.reactLoadableManifest&&t){let e=r.reactLoadableManifest;for(let r of t){if(!e[r])continue;let t=e[r].files.filter(e=>e.endsWith(".css"));o.push(...t)}}return 0===o.length?null:(0,i.jsx)(i.Fragment,{children:o.map(e=>(0,i.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:r.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},3039:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j,dynamic:()=>N});var i=r(326),s=r(7577);let o="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",n={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},a={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},l={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},h={b:[16,32,17,15],w:[-16,-32,-17,-15]},u={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},d=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],c=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],_={p:1,n:2,b:4,r:8,q:16,k:32},f=["n","b","r","q"],p={k:a.KSIDE_CASTLE,q:a.QSIDE_CASTLE},m={w:[{square:l.a1,flag:a.QSIDE_CASTLE},{square:l.h1,flag:a.KSIDE_CASTLE}],b:[{square:l.a8,flag:a.QSIDE_CASTLE},{square:l.h8,flag:a.KSIDE_CASTLE}]},g={b:1,w:6},b=["1-0","0-1","1/2-1/2","*"];function v(e){return -1!=="0123456789".indexOf(e)}function k(e){let t=15&e,r=e>>4;return"abcdefgh".substring(t,t+1)+"87654321".substring(r,r+1)}function E(e){return"w"===e?"b":"w"}function S(e,t,r,i,s,o,n=a.NORMAL){let l=i>>4;if("p"===s&&(7===l||0===l))for(let l=0;l<f.length;l++){let h=f[l];e.push({color:t,from:r,to:i,piece:s,captured:o,promotion:h,flags:n|a.PROMOTION})}else e.push({color:t,from:r,to:i,piece:s,captured:o,flags:n})}function x(e){let t=e.charAt(0);if(t>="a"&&t<="h"){if(e.match(/[a-h]\d.*[a-h]\d/))return;return"p"}return"o"===(t=t.toLowerCase())?"k":t}function C(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class y{_board=Array(128);_turn="w";_header={};_kings={w:-1,b:-1};_epSquare=-1;_halfMoves=0;_moveNumber=0;_history=[];_comments={};_castling={w:0,b:0};constructor(e=o){this.load(e)}clear(e=!1){this._board=Array(128),this._kings={w:-1,b:-1},this._turn="w",this._castling={w:0,b:0},this._epSquare=-1,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=e?this._header:{},this._updateSetup(this.fen())}removeHeader(e){e in this._header&&delete this._header[e]}load(e,t=!1){let r=e.split(/\s+/);r.length>=2&&r.length<6&&(e=r.concat(["-","-","0","1"].slice(-(6-r.length))).join(" ")),r=e.split(/\s+/);let{ok:i,error:s}=function(e){let t=e.split(/\s+/);if(6!==t.length)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};let r=parseInt(t[5],10);if(isNaN(r)||r<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};let i=parseInt(t[4],10);if(isNaN(i)||i<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(t[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(t[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(t[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};let s=t[0].split("/");if(8!==s.length)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let e=0;e<s.length;e++){let t=0,r=!1;for(let i=0;i<s[e].length;i++)if(v(s[e][i])){if(r)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};t+=parseInt(s[e][i],10),r=!0}else{if(!/^[prnbqkPRNBQK]$/.test(s[e][i]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};t+=1,r=!1}if(8!==t)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if("3"==t[3][1]&&"w"==t[1]||"6"==t[3][1]&&"b"==t[1])return{ok:!1,error:"Invalid FEN: illegal en-passant square"};for(let{color:e,regex:r}of[{color:"white",regex:/K/g},{color:"black",regex:/k/g}]){if(!r.test(t[0]))return{ok:!1,error:`Invalid FEN: missing ${e} king`};if((t[0].match(r)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${e} kings`}}return{ok:!0}}(e);if(!i)throw Error(s);let o=r[0],n=0;this.clear(t);for(let e=0;e<o.length;e++){let t=o.charAt(e);if("/"===t)n+=8;else if(v(t))n+=parseInt(t,10);else{let e=t<"a"?"w":"b";this.put({type:t.toLowerCase(),color:e},k(n)),n++}}this._turn=r[1],r[2].indexOf("K")>-1&&(this._castling.w|=a.KSIDE_CASTLE),r[2].indexOf("Q")>-1&&(this._castling.w|=a.QSIDE_CASTLE),r[2].indexOf("k")>-1&&(this._castling.b|=a.KSIDE_CASTLE),r[2].indexOf("q")>-1&&(this._castling.b|=a.QSIDE_CASTLE),this._epSquare="-"===r[3]?-1:l[r[3]],this._halfMoves=parseInt(r[4],10),this._moveNumber=parseInt(r[5],10),this._updateSetup(this.fen())}fen(){let e=0,t="";for(let r=l.a8;r<=l.h1;r++){if(this._board[r]){e>0&&(t+=e,e=0);let{color:i,type:s}=this._board[r];t+="w"===i?s.toUpperCase():s.toLowerCase()}else e++;r+1&136&&(e>0&&(t+=e),r!==l.h1&&(t+="/"),e=0,r+=8)}let r="";this._castling.w&a.KSIDE_CASTLE&&(r+="K"),this._castling.w&a.QSIDE_CASTLE&&(r+="Q"),this._castling.b&a.KSIDE_CASTLE&&(r+="k"),this._castling.b&a.QSIDE_CASTLE&&(r+="q"),r=r||"-";let i="-";if(-1!==this._epSquare){let e=this._epSquare+("w"===this._turn?16:-16);for(let t of[e+1,e-1]){if(136&t)continue;let e=this._turn;if(this._board[t]?.color===e&&this._board[t]?.type==="p"){this._makeMove({color:e,from:t,to:this._epSquare,piece:"p",captured:"p",flags:a.EP_CAPTURE});let r=!this._isKingAttacked(e);if(this._undoMove(),r){i=k(this._epSquare);break}}}}return[t,this._turn,r,i,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(e){this._history.length>0||(e!==o?(this._header.SetUp="1",this._header.FEN=e):(delete this._header.SetUp,delete this._header.FEN))}reset(){this.load(o)}get(e){return this._board[l[e]]||!1}put({type:e,color:t},r){if(-1==="pnbrqkPNBRQK".indexOf(e.toLowerCase())||!(r in l))return!1;let i=l[r];return("k"!=e||-1==this._kings[t]||this._kings[t]==i)&&(this._board[i]={type:e,color:t},"k"===e&&(this._kings[t]=i),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0)}remove(e){let t=this.get(e);return delete this._board[l[e]],t&&"k"===t.type&&(this._kings[t.color]=-1),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),t}_updateCastlingRights(){let e=this._board[l.e1]?.type==="k"&&this._board[l.e1]?.color==="w",t=this._board[l.e8]?.type==="k"&&this._board[l.e8]?.color==="b";e&&this._board[l.a1]?.type==="r"&&this._board[l.a1]?.color==="w"||(this._castling.w&=~a.QSIDE_CASTLE),e&&this._board[l.h1]?.type==="r"&&this._board[l.h1]?.color==="w"||(this._castling.w&=~a.KSIDE_CASTLE),t&&this._board[l.a8]?.type==="r"&&this._board[l.a8]?.color==="b"||(this._castling.b&=~a.QSIDE_CASTLE),t&&this._board[l.h8]?.type==="r"&&this._board[l.h8]?.color==="b"||(this._castling.b&=~a.KSIDE_CASTLE)}_updateEnPassantSquare(){if(-1===this._epSquare)return;let e=this._epSquare+("w"===this._turn?-16:16),t=this._epSquare+("w"===this._turn?16:-16);if(null!==this._board[e]||null!==this._board[this._epSquare]||this._board[t]?.color!==E(this._turn)||this._board[t]?.type!=="p"){this._epSquare=-1;return}[t+1,t-1].some(e=>!(136&e)&&this._board[e]?.color===this._turn&&this._board[e]?.type==="p")||(this._epSquare=-1)}_attacked(e,t){for(let r=l.a8;r<=l.h1;r++){if(136&r){r+=7;continue}if(void 0===this._board[r]||this._board[r].color!==e)continue;let i=this._board[r],s=r-t;if(0===s)continue;let o=s+119;if(d[o]&_[i.type]){if("p"===i.type){if(s>0){if("w"===i.color)return!0}else if("b"===i.color)return!0;continue}if("n"===i.type||"k"===i.type)return!0;let e=c[o],n=r+e,a=!1;for(;n!==t;){if(null!=this._board[n]){a=!0;break}n+=e}if(!a)return!0}}return!1}_isKingAttacked(e){let t=this._kings[e];return -1!==t&&this._attacked(E(e),t)}isAttacked(e,t){return this._attacked(t,l[e])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&0===this._moves().length}isStalemate(){return!this.isCheck()&&0===this._moves().length}isInsufficientMaterial(){let e={b:0,n:0,r:0,q:0,k:0,p:0},t=[],r=0,i=0;for(let s=l.a8;s<=l.h1;s++){if(i=(i+1)%2,136&s){s+=7;continue}let o=this._board[s];o&&(e[o.type]=o.type in e?e[o.type]+1:1,"b"===o.type&&t.push(i),r++)}if(2===r||3===r&&(1===e.b||1===e.n))return!0;if(r===e.b+2){let e=0,r=t.length;for(let i=0;i<r;i++)e+=t[i];if(0===e||e===r)return!0}return!1}isThreefoldRepetition(){let e=[],t={},r=!1;for(;;){let t=this._undoMove();if(!t)break;e.push(t)}for(;;){let i=this.fen().split(" ").slice(0,4).join(" ");t[i]=i in t?t[i]+1:1,t[i]>=3&&(r=!0);let s=e.pop();if(s)this._makeMove(s);else break}return r}isDraw(){return this._halfMoves>=100||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:e=!1,square:t,piece:r}={}){let i=this._moves({square:t,piece:r});return e?i.map(e=>this._makePretty(e)):i.map(e=>this._moveToSan(e,i))}_moves({legal:e=!0,piece:t,square:r}={}){let i=r?r.toLowerCase():void 0,s=t?.toLowerCase(),o=[],n=this._turn,d=E(n),c=l.a8,_=l.h1,f=!1;if(i){if(!(i in l))return[];c=_=l[i],f=!0}for(let e=c;e<=_;e++){let t;if(136&e){e+=7;continue}if(!this._board[e]||this._board[e].color===d)continue;let{type:r}=this._board[e];if("p"===r){if(s&&s!==r)continue;t=e+h[n][0],this._board[t]||(S(o,n,e,t,"p"),t=e+h[n][1],g[n]!==e>>4||this._board[t]||S(o,n,e,t,"p",void 0,a.BIG_PAWN));for(let r=2;r<4;r++)136&(t=e+h[n][r])||(this._board[t]?.color===d?S(o,n,e,t,"p",this._board[t].type,a.CAPTURE):t===this._epSquare&&S(o,n,e,t,"p","p",a.EP_CAPTURE))}else{if(s&&s!==r)continue;for(let i=0,s=u[r].length;i<s;i++){let s=u[r][i];for(t=e;!(136&(t+=s));){if(this._board[t]){if(this._board[t].color===n)break;S(o,n,e,t,r,this._board[t].type,a.CAPTURE);break}if(S(o,n,e,t,r),"n"===r||"k"===r)break}}}}if((void 0===s||"k"===s)&&(!f||_===this._kings[n])){if(this._castling[n]&a.KSIDE_CASTLE){let e=this._kings[n],t=e+2;this._board[e+1]||this._board[t]||this._attacked(d,this._kings[n])||this._attacked(d,e+1)||this._attacked(d,t)||S(o,n,this._kings[n],t,"k",void 0,a.KSIDE_CASTLE)}if(this._castling[n]&a.QSIDE_CASTLE){let e=this._kings[n],t=e-2;this._board[e-1]||this._board[e-2]||this._board[e-3]||this._attacked(d,this._kings[n])||this._attacked(d,e-1)||this._attacked(d,t)||S(o,n,this._kings[n],t,"k",void 0,a.QSIDE_CASTLE)}}if(!e||-1===this._kings[n])return o;let p=[];for(let e=0,t=o.length;e<t;e++)this._makeMove(o[e]),this._isKingAttacked(n)||p.push(o[e]),this._undoMove();return p}move(e,{strict:t=!1}={}){let r=null;if("string"==typeof e)r=this._moveFromSan(e,t);else if("object"==typeof e){let t=this._moves();for(let i=0,s=t.length;i<s;i++)if(e.from===k(t[i].from)&&e.to===k(t[i].to)&&(!("promotion"in t[i])||e.promotion===t[i].promotion)){r=t[i];break}}if(!r){if("string"==typeof e)throw Error(`Invalid move: ${e}`);throw Error(`Invalid move: ${JSON.stringify(e)}`)}let i=this._makePretty(r);return this._makeMove(r),i}_push(e){this._history.push({move:e,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(e){let t=this._turn,r=E(t);if(this._push(e),this._board[e.to]=this._board[e.from],delete this._board[e.from],e.flags&a.EP_CAPTURE&&("b"===this._turn?delete this._board[e.to-16]:delete this._board[e.to+16]),e.promotion&&(this._board[e.to]={type:e.promotion,color:t}),"k"===this._board[e.to].type){if(this._kings[t]=e.to,e.flags&a.KSIDE_CASTLE){let t=e.to-1,r=e.to+1;this._board[t]=this._board[r],delete this._board[r]}else if(e.flags&a.QSIDE_CASTLE){let t=e.to+1,r=e.to-2;this._board[t]=this._board[r],delete this._board[r]}this._castling[t]=0}if(this._castling[t]){for(let r=0,i=m[t].length;r<i;r++)if(e.from===m[t][r].square&&this._castling[t]&m[t][r].flag){this._castling[t]^=m[t][r].flag;break}}if(this._castling[r]){for(let t=0,i=m[r].length;t<i;t++)if(e.to===m[r][t].square&&this._castling[r]&m[r][t].flag){this._castling[r]^=m[r][t].flag;break}}e.flags&a.BIG_PAWN?"b"===t?this._epSquare=e.to-16:this._epSquare=e.to+16:this._epSquare=-1,"p"===e.piece?this._halfMoves=0:e.flags&(a.CAPTURE|a.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,"b"===t&&this._moveNumber++,this._turn=r}undo(){let e=this._undoMove();return e?this._makePretty(e):null}_undoMove(){let e=this._history.pop();if(void 0===e)return null;let t=e.move;this._kings=e.kings,this._turn=e.turn,this._castling=e.castling,this._epSquare=e.epSquare,this._halfMoves=e.halfMoves,this._moveNumber=e.moveNumber;let r=this._turn,i=E(r);if(this._board[t.from]=this._board[t.to],this._board[t.from].type=t.piece,delete this._board[t.to],t.captured){if(t.flags&a.EP_CAPTURE){let e;e="b"===r?t.to-16:t.to+16,this._board[e]={type:"p",color:i}}else this._board[t.to]={type:t.captured,color:i}}if(t.flags&(a.KSIDE_CASTLE|a.QSIDE_CASTLE)){let e,r;t.flags&a.KSIDE_CASTLE?(e=t.to+1,r=t.to-1):(e=t.to-2,r=t.to+1),this._board[e]=this._board[r],delete this._board[r]}return t}pgn({newline:e="\n",maxWidth:t=0}={}){let r=[],i=!1;for(let t in this._header)r.push("["+t+' "'+this._header[t]+'"]'+e),i=!0;i&&this._history.length&&r.push(e);let s=e=>{let t=this._comments[this.fen()];if(void 0!==t){let r=e.length>0?" ":"";e=`${e}${r}{${t}}`}return e},o=[];for(;this._history.length>0;)o.push(this._undoMove());let n=[],a="";for(0===o.length&&n.push(s(""));o.length>0;){a=s(a);let e=o.pop();if(!e)break;if(this._history.length||"b"!==e.color)"w"===e.color&&(a.length&&n.push(a),a=this._moveNumber+".");else{let e=`${this._moveNumber}. ...`;a=a?`${a} ${e}`:e}a=a+" "+this._moveToSan(e,this._moves({legal:!0})),this._makeMove(e)}if(a.length&&n.push(s(a)),void 0!==this._header.Result&&n.push(this._header.Result),0===t)return r.join("")+n.join(" ");let l=function(){return r.length>0&&" "===r[r.length-1]&&(r.pop(),!0)},h=0;for(let i=0;i<n.length;i++){if(h+n[i].length>t&&n[i].includes("{")){h=function(i,s){for(let o of s.split(" "))if(o){if(i+o.length>t){for(;l();)i--;r.push(e),i=0}r.push(o),i+=o.length,r.push(" "),i++}return l()&&i--,i}(h,n[i]);continue}h+n[i].length>t&&0!==i?(" "===r[r.length-1]&&r.pop(),r.push(e),h=0):0!==i&&(r.push(" "),h++),r.push(n[i]),h+=n[i].length}return r.join("")}header(...e){for(let t=0;t<e.length;t+=2)"string"==typeof e[t]&&"string"==typeof e[t+1]&&(this._header[e[t]]=e[t+1]);return this._header}loadPgn(e,{strict:t=!1,newlineChar:r="\r?\n"}={}){function i(e){return e.replace(/\\/g,"\\")}e=e.trim();let s=RegExp("^(\\[((?:"+i(r)+")|.)*\\])((?:\\s*"+i(r)+"){2}|(?:\\s*"+i(r)+")*$)").exec(e),o=s&&s.length>=2?s[1]:"";this.reset();let n=function(e){let t={},s=e.split(new RegExp(i(r))),o="",n="";for(let e=0;e<s.length;e++){let r=/^\s*\[\s*([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;o=s[e].replace(r,"$1"),n=s[e].replace(r,"$2"),o.trim().length>0&&(t[o]=n)}return t}(o),a="";for(let e in n)"fen"===e.toLowerCase()&&(a=n[e]),this.header(e,n[e]);if(t){if("1"===n.SetUp){if(!("FEN"in n))throw Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(n.FEN,!0)}}else a&&this.load(a,!0);let l=function(e){return e=e.replace(RegExp(i(r),"g")," "),`{${Array.from(e.slice(1,e.length-1)).map(function(e){return 128>e.charCodeAt(0)?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/%/g,"").toLowerCase()}).join("")}}`},h=e.replace(o,"").replace(RegExp(`({[^}]*})+?|;([^${i(r)}]*)`,"g"),function(e,t,r){return void 0!==t?l(t):" "+l(`{${r.slice(1)}}`)}).replace(RegExp(i(r),"g")," "),u=/(\([^()]+\))+?/g;for(;u.test(h);)h=h.replace(u,"");let d=(h=(h=(h=h.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).trim().split(new RegExp(/\s+/));d=d.filter(e=>""!==e);let c="";for(let e=0;e<d.length;e++){let r=function(e){if(e.startsWith("{")&&e.endsWith("}")){var t;return 0==(t=e.slice(1,e.length-1)).length?"":decodeURIComponent("%"+(t.match(/.{1,2}/g)||[]).join("%"))}}(d[e]);if(void 0!==r){this._comments[this.fen()]=r;continue}let i=this._moveFromSan(d[e],t);if(null==i){if(b.indexOf(d[e])>-1)c=d[e];else throw Error(`Invalid move in PGN: ${d[e]}`)}else c="",this._makeMove(i)}c&&Object.keys(this._header).length&&!this._header.Result&&this.header("Result",c)}_moveToSan(e,t){let r="";if(e.flags&a.KSIDE_CASTLE)r="O-O";else if(e.flags&a.QSIDE_CASTLE)r="O-O-O";else{if("p"!==e.piece){let i=function(e,t){let r=e.from,i=e.to,s=e.piece,o=0,n=0,a=0;for(let e=0,l=t.length;e<l;e++){let l=t[e].from,h=t[e].to;s===t[e].piece&&r!==l&&i===h&&(o++,r>>4==l>>4&&n++,(15&r)==(15&l)&&a++)}return o>0?n>0&&a>0?k(r):a>0?k(r).charAt(1):k(r).charAt(0):""}(e,t);r+=e.piece.toUpperCase()+i}e.flags&(a.CAPTURE|a.EP_CAPTURE)&&("p"===e.piece&&(r+=k(e.from)[0]),r+="x"),r+=k(e.to),e.promotion&&(r+="="+e.promotion.toUpperCase())}return this._makeMove(e),this.isCheck()&&(this.isCheckmate()?r+="#":r+="+"),this._undoMove(),r}_moveFromSan(e,t=!1){let r,i,s,o,n;let a=C(e),h=x(a),u=this._moves({legal:!0,piece:h});for(let e=0,t=u.length;e<t;e++)if(a===C(this._moveToSan(u[e],u)))return u[e];if(t)return null;let d=!1;if((i=a.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/))?(r=i[1],s=i[2],o=i[3],n=i[4],1==s.length&&(d=!0)):(i=a.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/))&&(r=i[1],s=i[2],o=i[3],n=i[4],1==s.length&&(d=!0)),h=x(a),u=this._moves({legal:!0,piece:r||h}),!o)return null;for(let e=0,t=u.length;e<t;e++)if(s){if((!r||r.toLowerCase()==u[e].piece)&&l[s]==u[e].from&&l[o]==u[e].to&&(!n||n.toLowerCase()==u[e].promotion))return u[e];if(d){let t=k(u[e].from);if((!r||r.toLowerCase()==u[e].piece)&&l[o]==u[e].to&&(s==t[0]||s==t[1])&&(!n||n.toLowerCase()==u[e].promotion))return u[e]}}else if(a===C(this._moveToSan(u[e],u)).replace("x",""))return u[e];return null}ascii(){let e="   +------------------------+\n";for(let t=l.a8;t<=l.h1;t++){if(0==(15&t)&&(e+=" "+"87654321"[t>>4]+" |"),this._board[t]){let r=this._board[t].type;e+=" "+("w"===this._board[t].color?r.toUpperCase():r.toLowerCase())+" "}else e+=" . ";t+1&136&&(e+="|\n",t+=8)}return e+"   +------------------------+\n     a  b  c  d  e  f  g  h"}perft(e){let t=this._moves({legal:!1}),r=0,i=this._turn;for(let s=0,o=t.length;s<o;s++)this._makeMove(t[s]),!this._isKingAttacked(i)&&(e-1>0?r+=this.perft(e-1):r++),this._undoMove();return r}_makePretty(e){let{color:t,piece:r,from:i,to:s,flags:o,captured:l,promotion:h}=e,u="";for(let e in a)a[e]&o&&(u+=n[e]);let d=k(i),c=k(s),_={color:t,piece:r,from:d,to:c,san:this._moveToSan(e,this._moves({legal:!0})),flags:u,lan:d+c,before:this.fen(),after:""};return this._makeMove(e),_.after=this.fen(),this._undoMove(),l&&(_.captured=l),h&&(_.promotion=h,_.lan+=h),_}turn(){return this._turn}board(){let e=[],t=[];for(let r=l.a8;r<=l.h1;r++)null==this._board[r]?t.push(null):t.push({square:k(r),type:this._board[r].type,color:this._board[r].color}),r+1&136&&(e.push(t),t=[],r+=8);return e}squareColor(e){if(e in l){let t=l[e];return((t>>4)+(15&t))%2==0?"light":"dark"}return null}history({verbose:e=!1}={}){let t=[],r=[];for(;this._history.length>0;)t.push(this._undoMove());for(;;){let i=t.pop();if(!i)break;e?r.push(this._makePretty(i)):r.push(this._moveToSan(i,this._moves())),this._makeMove(i)}return r}_pruneComments(){let e=[],t={},r=e=>{e in this._comments&&(t[e]=this._comments[e])};for(;this._history.length>0;)e.push(this._undoMove());for(r(this.fen());;){let t=e.pop();if(!t)break;this._makeMove(t),r(this.fen())}this._comments=t}getComment(){return this._comments[this.fen()]}setComment(e){this._comments[this.fen()]=e.replace("{","[").replace("}","]")}deleteComment(){let e=this._comments[this.fen()];return delete this._comments[this.fen()],e}getComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>({fen:e,comment:this._comments[e]}))}deleteComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>{let t=this._comments[e];return delete this._comments[e],{fen:e,comment:t}})}setCastlingRights(e,t){for(let r of["k","q"])void 0!==t[r]&&(t[r]?this._castling[e]|=p[r]:this._castling[e]&=~p[r]);this._updateCastlingRights();let r=this.getCastlingRights(e);return(void 0===t.k||t.k===r.k)&&(void 0===t.q||t.q===r.q)}getCastlingRights(e){return{k:(this._castling[e]&p.k)!=0,q:(this._castling[e]&p.q)!=0}}moveNumber(){return this._moveNumber}}r(4069);var P=r(5047),q=r(4645),I=r.n(q),w=r(3353);let A=r.n(w)()(()=>r.e(2).then(r.bind(r,9002)).then(e=>{let{Chessboard:t}=e;return t}),{ssr:!1,loading:()=>i.jsx("div",{className:I().loadingBoard,children:"Loading Chess Board..."})}),N="force-dynamic";function T(){let[e,t]=(0,s.useState)(new y),[r,o]=(0,s.useState)("white"),[n,a]=(0,s.useState)(""),[l,h]=(0,s.useState)(null),u=(0,s.useRef)(null),d=(0,P.useSearchParams)().get("room");return d?(0,i.jsxs)("div",{className:I().gameContainer,children:[i.jsx("div",{className:I().boardContainer,children:i.jsx(A,{id:"BasicBoard",position:e.fen(),onPieceDrop:function(i,s){if(console.log("\nAttempting move:"),console.log("From:",i),console.log("To:",s),console.log("Current turn:",e.turn()),console.log("Player color:",r),console.log("Current FEN:",e.fen()),"w"===e.turn()&&"white"!==r||"b"===e.turn()&&"black"!==r)return console.log("Not player's turn"),!1;try{let r=new y(e.fen()),o=r.move({from:i,to:s,promotion:"q"});if(null===o)return console.log("Invalid move"),!1;if(console.log("Move is valid, sending to server"),!u.current)return console.error("Socket connection not available"),!1;{let e={room:d,from:i,to:s,gameState:r.fen(),playerId:u.current.id};return console.log("\nEmitting move:",e),h({from:i,to:s}),t(r),u.current.emit("move",e),!0}}catch(e){return console.error("Error validating move:",e),!1}},boardOrientation:r})}),(0,i.jsxs)("div",{className:I().gameInfo,children:[(0,i.jsxs)("h2",{children:["Room: ",d]}),(0,i.jsxs)("p",{children:["Playing as: ",r]}),i.jsx("p",{className:I().status,children:n})]})]}):i.jsx("div",{className:I().error,children:"Invalid room ID"})}function j(){return i.jsx(s.Suspense,{fallback:i.jsx("div",{children:"Loading game..."}),children:i.jsx(T,{})})}},4069:(e,t,r)=>{"use strict";r.d(t,{h:()=>i}),r(57);let i=()=>null},4645:e=>{e.exports={gameContainer:"game_gameContainer__LW38N",boardContainer:"game_boardContainer__xp3dA",loadingBoard:"game_loadingBoard__MjclE",gameInfo:"game_gameInfo__sbXXa",status:"game_status__w98NB",error:"game_error__PEUsh"}},1814:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,dynamic:()=>s});var i=r(8570);let s=(0,i.createProxy)(String.raw`C:\Users\artem\YandexDisk\IT\dev\client\src\app\(user)\game\page.tsx#dynamic`),o=(0,i.createProxy)(String.raw`C:\Users\artem\YandexDisk\IT\dev\client\src\app\(user)\game\page.tsx#default`)},1557:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n,metadata:()=>o});var i=r(9510),s=r(7371);r(5023);let o={title:"Hybrid-Chess",description:"Full-stack TypeScript application"};function n({children:e}){return i.jsx("html",{lang:"en",children:(0,i.jsxs)("body",{children:[i.jsx("header",{className:"bg-gradient-to-r from-gray-800 to-gray-900 text-white shadow-lg",children:i.jsx("nav",{className:"container mx-auto px-4 py-3",children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"flex items-center space-x-2",children:i.jsx(s.default,{href:"/",className:"text-xl font-bold text-white",children:"♟ Hybrid-Chess"})}),(0,i.jsxs)("div",{className:"flex items-center space-x-6",children:[i.jsx(s.default,{href:"/",className:"text-gray-300 hover:text-white transition-colors duration-200 font-medium",children:"Home"}),i.jsx(s.default,{href:"/profile",className:"text-gray-300 hover:text-white transition-colors duration-200 font-medium",children:"Profile"})]})]})})}),i.jsx("div",{className:"min-h-screen bg-gray-900",children:e})]})})}},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[276,471,783,232],()=>r(1092));module.exports=i})();